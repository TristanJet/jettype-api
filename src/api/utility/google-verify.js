const { OAuth2Client } = require('google-auth-library');

const client = new OAuth2Client();
// const token = "eyJhbGciOiJSUzI1NiIsImtpZCI6IjBhZDFmZWM3ODUwNGY0NDdiYWU2NWJjZjVhZmFlZGI2NWVlYzllODEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI2NDQ2OTA1OTUxMzAtbHY0Y29zZzJrcGVpNDM0N2ZjNmQ0ODQydG03dm9nODcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI2NDQ2OTA1OTUxMzAtbHY0Y29zZzJrcGVpNDM0N2ZjNmQ0ODQydG03dm9nODcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDU3MDc5MTY5MTM3NjY1MDAwNjUiLCJlbWFpbCI6InRyaXN0YW5qZXRsYXlAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5iZiI6MTcwMjQ2MjQyNCwibmFtZSI6IlRyaXN0YW4gTGF5IiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0ozQi1CanJScnBhOWlkRUZyREl5SGcyTkNDTzU3QjJmRWEyZEdtQUdHSj1zOTYtYyIsImdpdmVuX25hbWUiOiJUcmlzdGFuIiwiZmFtaWx5X25hbWUiOiJMYXkiLCJsb2NhbGUiOiJlbiIsImlhdCI6MTcwMjQ2MjcyNCwiZXhwIjoxNzAyNDY2MzI0LCJqdGkiOiJiMGUxY2QwN2YxODZmZjlkZDk3YzU4YjA2ZjRhZWRlZjcwZDkzMTgyIn0.I44Pn9HYtiCXebUzeclUeoQhE0fPigAhi5PRdpK4Eb0mrzgJE8ZIfoFA2XHx3g0vxm40N6E2clvIkZZEVLvQ6jcJM0A1hhKhDB7yzpjfWoZgsN3mF1ci9FrUVl4VBhXwgtJG3FlDx5IE7Nq2PYE_i9BAZ1H6v-gfvEpMeDOe-mSGX9jK6DpHYnqrwXot1jFKqHlpkDNoJbRSe9GdAx3o65OimccpCHlHRRcAj-sCVhpL2lvgalPOt2mWcNLSlRk-qSFZUtfTfvZ9TrNXCvhorx2wZXbDhweMKzxaktNpQISo8VIeFqkdQvGRZ2mTeH4iRzi20a2faT6tk4npaDlaMg"

const verify = async (token) => {
  const ticket = await client.verifyIdToken({
    idToken: token,
    audience: process.env.GOOGLE_CLIENT_ID,
  });

  return ticket.getPayload();
};

module.exports = verify;
